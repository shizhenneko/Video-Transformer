system:
  max_api_calls: 20
  temp_dir: "./data/temp"
  output_dir: "./data/output"
  log_dir: "./data/output/logs"
  
  # Legacy self-check mode (preserved for backward compatibility)
  # Options: "lecture" (default, PDF-friendly) | "static" (legacy v2 format) | "default" (Core+Appendix format)
  self_check_mode: "lecture"
  
  # Note rendering style configuration (Core+Appendix vs Full Detail)
  # Options: "core_appendix" (default) | "full_detail" (legacy)
  # - core_appendix: Concise main content + detailed appendix
  # - full_detail: All details inline (legacy v2 behavior)
  note_style: "core_appendix"
  
  # Question scope configuration (chapter-level vs per-section)
  # Options: "chapter_only" (default) | "per_section" (legacy)
  # - chapter_only: One self-check block per chapter
  # - per_section: Self-check after each section (legacy v2 behavior)
  question_scope: "chapter_only"
  
  # Answer placement configuration (inline vs end-of-chapter)
  # Options: "inline_after_questions" (default) | "end_of_chapter"
  # - inline_after_questions: Answers immediately follow questions
  # - end_of_chapter: Answers in separate section at chapter end
  answer_placement: "inline_after_questions"
  
  # Code placement configuration (appendix vs inline)
  # Options: "appendix_only" (default) | "inline"
  # - appendix_only: Code blocks moved to appendix section
  # - inline: Code blocks remain in main content (legacy v2 behavior)
  code_placement: "appendix_only"
  
  # Note refiner configuration (automatic length optimization)
  note_refine:
    enabled: true
    lines_per_hour: 400
    min_lines: 220
    max_lines: 900
    tolerance_ratio: 0.10
    exclude_code_from_budget: false

proxy:
  base_url: "http://localhost:8000"
  http: "http://127.0.0.1:7897"  # Google API 代理地址
  timeout: 60
  verify_ssl: true

downloader:
  retry_times: 3
  video_format: "mp4"
  max_resolution: 360  # 最高分辨率 (480p 足够 Gemini 内容分析，大幅减小文件体积)
  sleep_interval: 2    # 请求间隔(秒)
  max_sleep_interval: 4  # 最大请求间隔(秒)

analyzer:
  model: "gemini-2.5-flash-lite"  # Gemini 模型名称
  temperature: 0.7               # 生成温度
  # Reduced from 150000 to avoid TPM (tokens-per-minute) throttling
  max_output_tokens: 65536        # 最大输出 token 数
  retry_times: 5                # API 调用重试次数 (429 限流时耐心重试)
  timeout: 120                   # API 调用超时时间(秒)
  min_call_interval: 10          # Gemini 调用最小间隔(秒), RPM=10 安全余量
  max_retry_wait: 600            # 重试总等待时间上限(秒), 即最长等 10 分钟
  max_continuations: 3            # MAX_TOKENS 截断时最大续传轮数
  long_video:
    enabled: true
    default_segment_seconds: 480
    overlap_seconds: 20
    min_segment_seconds: 90
    hard_max_api_calls: 50
    consolidate: true
    duration_threshold_seconds: null

validator:
  threshold: 75
  max_rounds: 3
  timeout: 30  # API 调用超时时间(秒)

image_generator:
  style: "paper"
  model: "nano-banana-pro"  # 支持: nano-banana-fast, nano-banana, nano-banana-pro, nano-banana-pro-vt, nano-banana-pro-cl
  aspect_ratio: "16:9"      # 支持: auto, 1:1, 16:9, 9:16, 4:3, 3:4, 3:2, 2:3, 5:4, 4:5, 21:9
  image_size: "1K"           # 支持: 1K, 2K, 4K (分辨率越高生成越慢)
  format: "png"
  quality: 95  # 图片质量(1-100)
  poll_interval: 3           # 轮询结果间隔(秒)
  poll_timeout: 180          # 轮询超时(秒)

auditor:
  model: "gemini-2.5-flash-lite"  # 审核使用的模型
  threshold: 75.0            # 审核合格阈值
  timeout: 60                # API 调用超时时间(秒)

api_keys:
  gemini: ""
  kimi: ""
  nano_banana: ""

grsai:
  base_url: "https://grsai.dakka.com.cn"
